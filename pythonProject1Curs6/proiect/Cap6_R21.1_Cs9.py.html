<html>
<head>
<title>Cap6_R21.1_Cs9.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #6a8759;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #cc7832;}
.s4 { color: #6897bb;}
.s5 { color: #629755; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Cap6_R21.1_Cs9.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
621 Clase avansat   
Stoc mostenit 
PF - 08.06.2021 v5 
&quot;&quot;&quot;  </span><span class="s2">#</span>

<span class="s0">''' 
Adaptati programul creat la exercitiul 521 astfel incat sa devina o superclasa si creati 
   2-3 subclase magazin1, 2, ... Fiecare subclasa va avea si 1-2 metode proprii 
 importam functia datetime din modulul datetimxe. Instructiune scrisa deja 
 Initializam o variabila 'cheie' care sa dea cheile unor dictionare 
 Cream o clasa 'Stoc' care va avea: 
    - 2 variabile statice, care sa numere cate produse avem si cate categorii (doar pentru avansati) 
    - o metoda constructor cu 
    denumire produs, categoria, unitatea de masura default 'Buc', sold default 0 
    initializare trei dictionate, cu cheie comuna, pentru data op., intrari si iesiri din stoc 
    - o metoda intrari cu 
 cantitatea, 
 data = str ( datetime.now ( ).strftime ( '%Y%m%d' ) ) 
 testam daca cheia se gaseste in dictionarul cu data op. Daca exista stabileste cheia 
   ca fiind maximul cheilor existente plus 1, altfel va fi egala cu 1 
 introduce in dict intrari cheie si cant 
 introduce in dict data cheie si data op 
 actualizeaza soldul 
    - o metoda iesiri, similara cu precedenta. Diferente: populam dict iesiri 
    - o metoda fisa produsului cu urmatoarele specificatii: 
 Sa printeze 'Fisa produsului denumire_produs' (sa stim si noi a cui e fisa) 
 Sa printeze ' Nrc ', '  Data  ', ' Intra', ' Iese' pentru toate tranzactiile produsului 
 Sa printeze stocul actual al produsului 
 pentru avansati - aliniati coloanele 
 Creati trei instante (produse). Pentru 2 din ele efecturati cate 4-5 operatiuni (intrari, iesiri) 
 Apelati metoda fisa produsului pentru cele 2 produse 
''' </span><span class="s2">#</span>

<span class="s3">from </span><span class="s1">datetime </span><span class="s3">import </span><span class="s1">datetime</span>

<span class="s3">class </span><span class="s1">Stoc:</span>

    <span class="s1">lista_produse = []</span>
    <span class="s1">dictionar_categorii = {}</span>

    <span class="s3">def </span><span class="s1">__init__(self</span><span class="s3">, </span><span class="s1">denp</span><span class="s3">, </span><span class="s1">categ</span><span class="s3">, </span><span class="s1">um = </span><span class="s0">'Buc'</span><span class="s3">, </span><span class="s1">sold = </span><span class="s4">0</span><span class="s3">, </span><span class="s1">rezervat = </span><span class="s4">0</span><span class="s1">):</span>
        <span class="s1">self.denp = denp</span>
        <span class="s1">self.categ = categ</span>
        <span class="s1">self.um = um</span>
        <span class="s1">self.rezervat = rezervat</span>
        <span class="s1">self.sold =sold</span>
        <span class="s1">self.miscari = {}</span>
        <span class="s1">self.lista_produse.append(self.denp)</span>
        <span class="s3">if </span><span class="s1">self.categ </span><span class="s3">in </span><span class="s1">self.dictionar_categorii.keys():</span>
            <span class="s1">self.dictionar_categorii[self.categ] += [self.denp]</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">self.dictionar_categorii[self.categ] = [self.denp]</span>

    <span class="s3">def </span><span class="s1">intrari(self</span><span class="s3">, </span><span class="s1">cant</span><span class="s3">, </span><span class="s1">data = str ( datetime.now ( ).strftime ( </span><span class="s0">'%Y%m%d' </span><span class="s1">) ) ):</span>
        <span class="s1">self.cant = cant</span>
        <span class="s1">self.date = data</span>
        <span class="s1">cheie = self.gen_cheia()</span>
        <span class="s1">self.miscari[cheie] = (self.date</span><span class="s3">, </span><span class="s1">self.cant</span><span class="s3">, </span><span class="s4">0</span><span class="s1">)</span>
        <span class="s1">self.sold += self.cant</span>

    <span class="s3">def </span><span class="s1">iesiri(self</span><span class="s3">, </span><span class="s1">cant</span><span class="s3">, </span><span class="s1">data = str ( datetime.now ( ).strftime ( </span><span class="s0">'%Y%m%d' </span><span class="s1">) ) ):</span>
        <span class="s1">self.cant = cant</span>
        <span class="s1">self.date = data</span>
        <span class="s1">cheie = self.gen_cheia()</span>
        <span class="s1">self.miscari[cheie] = (self.date</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s1">self.cant)</span>
        <span class="s1">self.sold -= self.cant</span>

    <span class="s3">def </span><span class="s1">fisap(self):</span>
        <span class="s1">print(</span><span class="s0">'*-* ' </span><span class="s1">* </span><span class="s4">8</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s0">'Fisa produsului {0}, {1}'</span><span class="s1">.format(self.denp</span><span class="s3">, </span><span class="s1">self.um))</span>
        <span class="s1">print(</span><span class="s0">'-' </span><span class="s1">* </span><span class="s4">30</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s0">' Nrc '</span><span class="s3">, </span><span class="s0">'  Data  '</span><span class="s3">, </span><span class="s0">' Intrare'</span><span class="s3">, </span><span class="s0">' Iesire'</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s0">'-' </span><span class="s1">* </span><span class="s4">30</span><span class="s1">)</span>
        <span class="s3">for </span><span class="s1">cheie </span><span class="s3">in </span><span class="s1">self.miscari:</span>
            <span class="s1">print(str(cheie).rjust(</span><span class="s4">3</span><span class="s1">)</span><span class="s3">,</span>
                  <span class="s1">str(self.miscari[cheie][</span><span class="s4">0</span><span class="s1">]).rjust(</span><span class="s4">10</span><span class="s1">)</span><span class="s3">,</span>
                  <span class="s1">str(self.miscari[cheie][</span><span class="s4">1</span><span class="s1">]).rjust(</span><span class="s4">8</span><span class="s1">)</span><span class="s3">,</span>
                  <span class="s1">str(self.miscari[cheie][</span><span class="s4">2</span><span class="s1">]).rjust(</span><span class="s4">6</span><span class="s1">))</span>
        <span class="s1">print(</span><span class="s0">'-' </span><span class="s1">* </span><span class="s4">30</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s0">'Stocul final </span><span class="s3">\t\t\t </span><span class="s0">{0}'</span><span class="s1">.format(self.sold))</span>
        <span class="s1">print(</span><span class="s0">'*-* ' </span><span class="s1">* </span><span class="s4">8</span><span class="s1">)</span>

    <span class="s3">def </span><span class="s1">gen_cheia(self):</span>
        <span class="s3">if </span><span class="s1">self.miscari.keys ():</span>
            <span class="s1">cheie = max (self.miscari.keys ()) + </span><span class="s4">1</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">cheie = </span><span class="s4">1</span>
        <span class="s3">return </span><span class="s1">cheie</span>


<span class="s3">class </span><span class="s1">depozit_mogosoaia(Stoc):</span>

    <span class="s3">def </span><span class="s1">perisabilitati(self</span><span class="s3">, </span><span class="s1">procent_aplicat):</span>
        <span class="s5">'''Atentie, procentul va fi de forma .01 pentru 1%'''</span>
        <span class="s1">suma = </span><span class="s4">0</span>
        <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">self.miscari.values():</span>
            <span class="s1">suma += i[</span><span class="s4">1</span><span class="s1">]</span>
        <span class="s1">perisabilitati = int(procent_aplicat * suma)</span>
        <span class="s1">self.iesiri(perisabilitati)</span>

    <span class="s3">def </span><span class="s1">cauta_tranzactii(self</span><span class="s3">,</span>
                            <span class="s1">data_start= str(datetime.now().strftime(</span><span class="s0">'%Y0101'</span><span class="s1">))</span><span class="s3">,</span>
                            <span class="s1">data_final = str(datetime.now().strftime(</span><span class="s0">'%Y1231'</span><span class="s1">))):</span>
        <span class="s3">if </span><span class="s1">self.miscari != {}:</span>
            <span class="s1">print(</span><span class="s0">'*-* ' </span><span class="s1">* </span><span class="s4">8</span><span class="s1">)</span>
            <span class="s1">print(</span><span class="s0">'Fisa produsului {0}, {1} </span><span class="s3">\n</span><span class="s0">intre {2} si {3}'</span><span class="s1">.</span>
                  <span class="s1">format(self.denp</span><span class="s3">, </span><span class="s1">self.um</span><span class="s3">, </span><span class="s1">data_start</span><span class="s3">, </span><span class="s1">data_final)</span>
                  <span class="s1">)</span>
            <span class="s1">print(</span><span class="s0">'-' </span><span class="s1">* </span><span class="s4">30</span><span class="s1">)</span>
            <span class="s1">print(</span><span class="s0">' Nrc '</span><span class="s3">, </span><span class="s0">'  Data  '</span><span class="s3">, </span><span class="s0">' Intrare'</span><span class="s3">, </span><span class="s0">' Iesire'</span><span class="s1">)</span>
            <span class="s1">print(</span><span class="s0">'-' </span><span class="s1">* </span><span class="s4">30</span><span class="s1">)</span>
            <span class="s3">for </span><span class="s1">i </span><span class="s3">in </span><span class="s1">self.miscari.keys():</span>
                <span class="s3">if </span><span class="s1">data_start &lt;= self.miscari[i][</span><span class="s4">0</span><span class="s1">] </span><span class="s3">and </span><span class="s1">data_final &gt;= self.miscari[i][</span><span class="s4">0</span><span class="s1">]:</span>
                    <span class="s1">print(i</span><span class="s3">,</span>
                          <span class="s1">str(self.miscari[i][</span><span class="s4">0</span><span class="s1">]).rjust(</span><span class="s4">10</span><span class="s1">)</span><span class="s3">,</span>
                          <span class="s1">str(self.miscari[i][</span><span class="s4">1</span><span class="s1">]).rjust(</span><span class="s4">8</span><span class="s1">)</span><span class="s3">,</span>
                          <span class="s1">str(self.miscari[i][</span><span class="s4">2</span><span class="s1">]).rjust(</span><span class="s4">6</span><span class="s1">))</span>
            <span class="s1">print(</span><span class="s0">'-' </span><span class="s1">* </span><span class="s4">30</span><span class="s1">)</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">print(</span><span class="s0">'Sold zero'</span><span class="s1">)</span>

<span class="s3">class </span><span class="s1">dep_buc(Stoc):</span>

    <span class="s3">def </span><span class="s1">rezerva(self</span><span class="s3">, </span><span class="s1">cant):</span>
        <span class="s3">if </span><span class="s1">self.rezervat:</span>
            <span class="s1">self.rezervat += cant</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">self.rezervat = cant</span>

    <span class="s3">def </span><span class="s1">iesiri(self</span><span class="s3">, </span><span class="s1">cant</span><span class="s3">, </span><span class="s1">data = str ( datetime.now ( ).strftime ( </span><span class="s0">'%Y%m%d' </span><span class="s1">) ) ):</span>
        <span class="s1">self.cant = cant</span>
        <span class="s1">self.date = data</span>
        <span class="s3">if </span><span class="s1">self.miscari.keys():</span>
            <span class="s1">cheie = max(self.miscari.keys())  + </span><span class="s4">1</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">cheie = </span><span class="s4">1</span>
        <span class="s3">if </span><span class="s1">self.cant &lt;= self.sold </span><span class="s3">and </span><span class="s1">self.cant &lt;= self.sold - self.rezervat:</span>
                    <span class="s1">self.miscari[cheie] = (self.date</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s1">self.cant)</span>
                    <span class="s1">self.sold -= self.cant</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">print(</span><span class="s0">&quot;operatiune imposibila. stoc insuficient&quot;</span><span class="s1">)</span>

    <span class="s3">def </span><span class="s1">val_stoc(self</span><span class="s3">, </span><span class="s1">pret):</span>
        <span class="s3">return </span><span class="s1">pret * self.sold</span>



<span class="s1">bere = depozit_mogosoaia(</span><span class="s0">'bere'</span><span class="s3">, </span><span class="s0">'aliment'</span><span class="s3">, </span><span class="s0">'doze'</span><span class="s1">)</span>

<span class="s1">bere.intrari(</span><span class="s4">1000</span><span class="s3">, </span><span class="s0">'20170206'</span><span class="s1">)</span>
<span class="s1">bere.iesiri(</span><span class="s4">870</span><span class="s3">, </span><span class="s0">'20170308'</span><span class="s1">)</span>
<span class="s1">bere.intrari(</span><span class="s4">2500</span><span class="s3">, </span><span class="s0">'20170509'</span><span class="s1">)</span>
<span class="s1">bere.iesiri(</span><span class="s4">1897</span><span class="s1">)</span>
<span class="s1">bere.perisabilitati(</span><span class="s4">.01</span><span class="s1">)</span>
<span class="s1">bere.fisap()</span>
<span class="s1">bere.cauta_tranzactii(</span><span class="s0">'20170301'</span><span class="s3">, </span><span class="s0">'20170331'</span><span class="s1">)</span>

<span class="s1">alune = dep_buc(</span><span class="s0">'alune'</span><span class="s3">, </span><span class="s0">'fructe'</span><span class="s1">)</span>

<span class="s1">alune.intrari(</span><span class="s4">900</span><span class="s3">, </span><span class="s0">'20170206'</span><span class="s1">)</span>
<span class="s1">alune.iesiri(</span><span class="s4">830</span><span class="s3">, </span><span class="s0">'20170308'</span><span class="s1">)</span>
<span class="s1">alune.intrari(</span><span class="s4">2300</span><span class="s3">, </span><span class="s0">'20170509'</span><span class="s1">)</span>
<span class="s1">alune.iesiri(</span><span class="s4">1397</span><span class="s1">)</span>

<span class="s1">alune.fisap()</span>

<span class="s1">alune.rezerva(</span><span class="s4">500</span><span class="s1">)</span>

<span class="s1">alune.iesiri(</span><span class="s4">500</span><span class="s1">)</span>

<span class="s1">alune.sold</span></pre>
</body>
</html>